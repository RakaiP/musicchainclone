{"ast":null,"code":"var _jsxFileName = \"/home/fergussojr/Documents/UGM/BlockChain/Demo/finalproject/MusicChain/react/src/SongDetailPage.js\",\n    _s = $RefreshSig$();\n\nimport React, { useState, useEffect } from \"react\";\nimport clsx from \"clsx\";\nimport { downloadAudioIPFS } from \"./ipfs/download\";\nimport Moment from \"moment\";\nimport AlbumIcon from \"@material-ui/icons/Album\";\nimport { makeStyles, Container, Grid, Paper, Typography, TextField, Button, Stepper, Step, StepContent, StepLabel } from \"@material-ui/core\";\nimport Timeline from \"@material-ui/lab/Timeline\";\nimport TimelineItem from \"@material-ui/lab/TimelineItem\";\nimport TimelineSeparator from \"@material-ui/lab/TimelineSeparator\";\nimport TimelineConnector from \"@material-ui/lab/TimelineConnector\";\nimport TimelineContent from \"@material-ui/lab/TimelineContent\";\nimport TimelineDot from \"@material-ui/lab/TimelineDot\";\nimport TimelineOppositeContent from \"@material-ui/lab/TimelineOppositeContent\";\nimport GetAppIcon from \"@material-ui/icons/GetApp\";\nimport { useParams, useHistory } from \"react-router\";\nimport { BrowserRouter as Router, Link } from \"react-router-dom\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst useStyles = makeStyles(theme => ({\n  container: {\n    paddingTop: theme.spacing(5),\n    paddingLeft: theme.spacing(5),\n    paddingRight: theme.spacing(5),\n    paddingBottom: theme.spacing(5),\n    backgroundColor: \"#202020\"\n  },\n  paper: {\n    padding: theme.spacing(2),\n    display: \"flex\",\n    overflow: \"auto\",\n    flexDirection: \"column\",\n    backgroundColor: \"#808080\"\n  },\n  fixedHeight: {\n    height: 480\n  },\n  inputForm: {\n    \"& .MuiTextField-root\": {\n      margin: theme.spacing(2),\n      marginLeft: theme.spacing(4),\n      marginRight: theme.spacing(4),\n      width: \"36ch\"\n    }\n  },\n  testingButtons: {\n    \"& > *\": {\n      margin: theme.spacing(2),\n      marginBottom: theme.spacing(3)\n    }\n  },\n  downloadForm: {\n    \"& .MuiTextField-root\": {\n      margin: theme.spacing(2),\n      marginLeft: theme.spacing(4),\n      marginRight: theme.spacing(4),\n      marginBottom: theme.spacing(3),\n      width: \"60ch\"\n    }\n  },\n  downloadbutton: {\n    position: \"relative\",\n    backgroundColor: \"#39a9cb\",\n    margin: theme.spacing(2),\n    marginLeft: theme.spacing(4),\n    marginRight: theme.spacing(4),\n    height: \"5ch\"\n  },\n  audioplayer: {\n    margin: theme.spacing(2)\n  }\n}));\n\nconst SongDetailPage = props => {\n  _s();\n\n  const classes = useStyles();\n  const fixedHeightPaper = clsx(classes.paper);\n  const history = useHistory(); // from props\n\n  const web3 = props.web3;\n  const accounts = props.accounts;\n  const contract = props.contract;\n  const musicList = props.musicList;\n  const setMusicList = props.setMusicList;\n  const setPage = props.setPage; // for alert msg\n\n  const callAlert = props.callAlert; // states\n\n  const [songHash, setSongHash] = useState(\"\");\n  const [songName, setSongName] = useState(\"\");\n  const [songArtist, setSongArtist] = useState(\"\");\n  const [searchHash, setSearchHash] = useState(\"\");\n  const [songData, setSongData] = useState({});\n  const [isMyMusic, setIsMyMusic] = useState(false);\n  const [isPurchased, setIsPurchased] = useState(false);\n  const [copyrightChain, setCopyrightChain] = useState([]);\n  const [userBalance, setUserBalance] = useState(0);\n  const {\n    queryhash\n  } = useParams();\n  useEffect(() => {\n    setPage(\"Detail\");\n    setSearchHash(queryhash);\n  }, []);\n  useEffect(async () => {\n    await getMusicByHash();\n  }, [accounts, contract, queryhash]);\n  useEffect(async () => {\n    await getUserBalance();\n  }, [accounts, contract]); // const testGetMusic = async () => {\n  //   const result = await contract.methods\n  //     .getMusic(searchMusic, searchArtist)\n  //     .call({ from: accounts[0] });\n  //   console.log(result);\n  //   console.log(result.ipfsHash);\n  //   setSongHash(result.ipfsHash);\n  // };\n\n  const getMusicByHash = async () => {\n    if (contract.methods == undefined) {\n      return;\n    } else if (accounts.length == 0) {\n      return;\n    }\n\n    const result = await contract.methods.getMusicByHash(queryhash).call({\n      from: accounts[0]\n    });\n    setSongData(result);\n    const result_own = await contract.methods.findUploadMusic(queryhash).call({\n      from: accounts[0]\n    });\n    setIsMyMusic(result_own);\n    const result_purchased = await contract.methods.findBoughtMusic(queryhash).call({\n      from: accounts[0]\n    });\n    setIsPurchased(result_purchased);\n    const result_chain = await contract.methods.getMusicChainByHash(queryhash, 10).call({\n      from: accounts[0]\n    });\n    console.log(\"result_chain\");\n    console.log(result_chain.filter(x => x.ipfsHash !== \"\"));\n    setCopyrightChain(result_chain.filter(x => x.ipfsHash !== \"\"));\n  };\n\n  const getUserBalance = async () => {\n    if (contract.methods == undefined) {\n      return;\n    } else if (accounts.length == 0) {\n      return;\n    }\n\n    const balance = await contract.methods.getUserBalance().call({\n      from: accounts[0]\n    });\n    setUserBalance(balance);\n    return balance;\n  };\n\n  const checkUserBalance = async () => {\n    const balance = await contract.methods.getUserBalance().call({\n      from: accounts[0]\n    });\n    setUserBalance(balance);\n\n    if (parseInt(balance) < 100) {\n      console.log(\"You have no enough balance!\");\n      return false;\n    }\n\n    return true;\n  };\n\n  const buyMusic = async () => {\n    const hasEnoughBalance = await checkUserBalance();\n\n    if (!hasEnoughBalance) {\n      return;\n    }\n\n    const result = await contract.methods.buyMusicByHash(queryhash).send({\n      from: accounts[0]\n    });\n    console.log(result);\n    await getMusicByHash();\n  };\n\n  return /*#__PURE__*/_jsxDEV(Container, {\n    maxWidth: \"lg\",\n    className: classes.container,\n    children: /*#__PURE__*/_jsxDEV(Grid, {\n      container: true,\n      spacing: 3,\n      children: [/*#__PURE__*/_jsxDEV(Grid, {\n        item: true,\n        xs: 12,\n        md: 8,\n        lg: 8,\n        children: /*#__PURE__*/_jsxDEV(Paper, {\n          className: fixedHeightPaper,\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            children: /*#__PURE__*/_jsxDEV(Typography, {\n              component: \"h2\",\n              variant: \"h1\",\n              gutterBottom: true,\n              style: {\n                color: \"white\",\n                fontSize: 40\n              },\n              children: songData[\"name\"]\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 216,\n              columnNumber: 15\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 215,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            children: /*#__PURE__*/_jsxDEV(Typography, {\n              component: \"h2\",\n              variant: \"h6\",\n              gutterBottom: true,\n              style: {\n                color: \"white\",\n                fontSize: 20\n              },\n              children: [\"Artist : \", songData[\"artist\"]]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 226,\n              columnNumber: 15\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 225,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            children: /*#__PURE__*/_jsxDEV(Typography, {\n              component: \"h2\",\n              variant: \"h6\",\n              gutterBottom: true,\n              style: {\n                color: \"white\",\n                fontSize: 20\n              },\n              children: [\"Upload Time :\", \" \", Moment.unix(songData[\"uploadTime\"]).zone(8).format(\"MM/D/YYYY, hh:mm:ss\")]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 236,\n              columnNumber: 15\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 235,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            children: /*#__PURE__*/_jsxDEV(Typography, {\n              component: \"h2\",\n              variant: \"h6\",\n              gutterBottom: true,\n              style: {\n                color: \"white\",\n                fontSize: 20\n              },\n              children: [\"Ipfs Hash : \", songData[\"ipfsHash\"]]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 249,\n              columnNumber: 15\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 248,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            children: /*#__PURE__*/_jsxDEV(Typography, {\n              component: \"h2\",\n              variant: \"h6\",\n              gutterBottom: true,\n              style: {\n                color: \"white\",\n                fontSize: 20\n              },\n              children: [\"Uploader : \", songData[\"uploader\"]]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 259,\n              columnNumber: 15\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 258,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(Typography, {\n            component: \"h2\",\n            variant: \"h6\",\n            gutterBottom: true,\n            style: {\n              color: \"white\",\n              fontSize: 15\n            }\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 269,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"form\", {\n            className: classes.inputForm,\n            noValidate: true,\n            autoComplete: \"off\",\n            children: /*#__PURE__*/_jsxDEV(\"div\", {\n              className: classes.testingButtons,\n              children: /*#__PURE__*/_jsxDEV(Button, {\n                variant: \"contained\",\n                disabled: !isMyMusic && !isPurchased && parseInt(userBalance) < 100,\n                onClick: async () => {\n                  if (isMyMusic || isPurchased) {\n                    // code to call our footer music player\n                    let music_src = await downloadAudioIPFS(songData[\"ipfsHash\"]);\n                    console.log(music_src); // use songData[\"name\"],songData[\"artist\"],songData[\"uploader\"]\n\n                    let music = {\n                      id: songData[\"ipfsHash\"],\n                      name: songData[\"name\"],\n                      artist: songData[\"artist\"],\n                      onChoose: true,\n                      onPlay: true,\n                      src: music_src\n                    };\n                    let newList = musicList.map(m => {\n                      m.onPlay = true;\n                      m.onChoose = false;\n                      return m;\n                    });\n                    setMusicList([...newList, music]);\n                  } else {\n                    buyMusic();\n                  }\n                },\n                children: isMyMusic || isPurchased ? \"Play Music\" : \"Buy Music\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 324,\n                columnNumber: 17\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 323,\n              columnNumber: 15\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 282,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(Typography, {\n            component: \"h2\",\n            variant: \"h6\",\n            gutterBottom: true,\n            style: {\n              color: \"orange\",\n              fontSize: 20\n            },\n            children: parseInt(userBalance) < 100 && !isMyMusic && !isPurchased ? \"No enough balance!\" : \"\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 360,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 214,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 213,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(Grid, {\n        item: true,\n        xs: 12,\n        md: 4,\n        lg: 4,\n        children: /*#__PURE__*/_jsxDEV(Paper, {\n          className: fixedHeightPaper,\n          children: [/*#__PURE__*/_jsxDEV(Typography, {\n            component: \"h2\",\n            variant: \"h6\",\n            gutterBottom: true,\n            style: {\n              color: \"white\",\n              fontSize: 20\n            },\n            children: \"Copyright Chain\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 374,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(Timeline, {\n            align: \"right\",\n            children: copyrightChain.length && copyrightChain.map((ent, index) => {\n              return /*#__PURE__*/_jsxDEV(TimelineItem, {\n                children: [/*#__PURE__*/_jsxDEV(TimelineOppositeContent, {\n                  children: /*#__PURE__*/_jsxDEV(Typography, {\n                    color: \"textSecondary\",\n                    children: ent.artist\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 389,\n                    columnNumber: 25\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 388,\n                  columnNumber: 23\n                }, this), /*#__PURE__*/_jsxDEV(TimelineSeparator, {\n                  children: [/*#__PURE__*/_jsxDEV(TimelineDot, {\n                    color: index == 0 ? \"secondary\" : \"primary\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 394,\n                    columnNumber: 25\n                  }, this), /*#__PURE__*/_jsxDEV(TimelineConnector, {}, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 397,\n                    columnNumber: 25\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 393,\n                  columnNumber: 23\n                }, this), /*#__PURE__*/_jsxDEV(TimelineContent, {\n                  children: /*#__PURE__*/_jsxDEV(Typography, {\n                    children: searchHash == ent.ipfsHash ? ent.name : /*#__PURE__*/_jsxDEV(Button, {\n                      onClick: () => {\n                        history.push(`/detail/${ent.ipfsHash}`);\n                      },\n                      children: ent.name\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 405,\n                      columnNumber: 29\n                    }, this)\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 400,\n                    columnNumber: 25\n                  }, this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 399,\n                  columnNumber: 23\n                }, this)]\n              }, ent.ipfsHash, true, {\n                fileName: _jsxFileName,\n                lineNumber: 387,\n                columnNumber: 21\n              }, this);\n            })\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 383,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 373,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 372,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 212,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 211,\n    columnNumber: 5\n  }, this);\n};\n\n_s(SongDetailPage, \"jQyi369pKUIUSNASgTViurbsh1w=\", false, function () {\n  return [useStyles, useHistory, useParams];\n});\n\n_c = SongDetailPage;\nexport default SongDetailPage;\n\nvar _c;\n\n$RefreshReg$(_c, \"SongDetailPage\");","map":{"version":3,"sources":["/home/fergussojr/Documents/UGM/BlockChain/Demo/finalproject/MusicChain/react/src/SongDetailPage.js"],"names":["React","useState","useEffect","clsx","downloadAudioIPFS","Moment","AlbumIcon","makeStyles","Container","Grid","Paper","Typography","TextField","Button","Stepper","Step","StepContent","StepLabel","Timeline","TimelineItem","TimelineSeparator","TimelineConnector","TimelineContent","TimelineDot","TimelineOppositeContent","GetAppIcon","useParams","useHistory","BrowserRouter","Router","Link","useStyles","theme","container","paddingTop","spacing","paddingLeft","paddingRight","paddingBottom","backgroundColor","paper","padding","display","overflow","flexDirection","fixedHeight","height","inputForm","margin","marginLeft","marginRight","width","testingButtons","marginBottom","downloadForm","downloadbutton","position","audioplayer","SongDetailPage","props","classes","fixedHeightPaper","history","web3","accounts","contract","musicList","setMusicList","setPage","callAlert","songHash","setSongHash","songName","setSongName","songArtist","setSongArtist","searchHash","setSearchHash","songData","setSongData","isMyMusic","setIsMyMusic","isPurchased","setIsPurchased","copyrightChain","setCopyrightChain","userBalance","setUserBalance","queryhash","getMusicByHash","getUserBalance","methods","undefined","length","result","call","from","result_own","findUploadMusic","result_purchased","findBoughtMusic","result_chain","getMusicChainByHash","console","log","filter","x","ipfsHash","balance","checkUserBalance","parseInt","buyMusic","hasEnoughBalance","buyMusicByHash","send","color","fontSize","unix","zone","format","music_src","music","id","name","artist","onChoose","onPlay","src","newList","map","m","ent","index","push"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from \"react\";\nimport clsx from \"clsx\";\nimport { downloadAudioIPFS } from \"./ipfs/download\";\nimport Moment from \"moment\";\nimport AlbumIcon from \"@material-ui/icons/Album\";\n\nimport {\n  makeStyles,\n  Container,\n  Grid,\n  Paper,\n  Typography,\n  TextField,\n  Button,\n  Stepper,\n  Step,\n  StepContent,\n  StepLabel,\n} from \"@material-ui/core\";\n\nimport Timeline from \"@material-ui/lab/Timeline\";\nimport TimelineItem from \"@material-ui/lab/TimelineItem\";\nimport TimelineSeparator from \"@material-ui/lab/TimelineSeparator\";\nimport TimelineConnector from \"@material-ui/lab/TimelineConnector\";\nimport TimelineContent from \"@material-ui/lab/TimelineContent\";\nimport TimelineDot from \"@material-ui/lab/TimelineDot\";\nimport TimelineOppositeContent from \"@material-ui/lab/TimelineOppositeContent\";\n\nimport GetAppIcon from \"@material-ui/icons/GetApp\";\nimport { useParams, useHistory } from \"react-router\";\nimport { BrowserRouter as Router, Link } from \"react-router-dom\";\n\nconst useStyles = makeStyles((theme) => ({\n  container: {\n    paddingTop: theme.spacing(5),\n    paddingLeft: theme.spacing(5),\n    paddingRight: theme.spacing(5),\n    paddingBottom: theme.spacing(5),\n    backgroundColor: \"#202020\",\n  },\n  paper: {\n    padding: theme.spacing(2),\n    display: \"flex\",\n    overflow: \"auto\",\n    flexDirection: \"column\",\n    backgroundColor: \"#808080\",\n  },\n  fixedHeight: {\n    height: 480,\n  },\n  inputForm: {\n    \"& .MuiTextField-root\": {\n      margin: theme.spacing(2),\n      marginLeft: theme.spacing(4),\n      marginRight: theme.spacing(4),\n      width: \"36ch\",\n    },\n  },\n  testingButtons: {\n    \"& > *\": {\n      margin: theme.spacing(2),\n      marginBottom: theme.spacing(3),\n    },\n  },\n  downloadForm: {\n    \"& .MuiTextField-root\": {\n      margin: theme.spacing(2),\n      marginLeft: theme.spacing(4),\n      marginRight: theme.spacing(4),\n      marginBottom: theme.spacing(3),\n      width: \"60ch\",\n    },\n  },\n  downloadbutton: {\n    position: \"relative\",\n    backgroundColor: \"#39a9cb\",\n    margin: theme.spacing(2),\n    marginLeft: theme.spacing(4),\n    marginRight: theme.spacing(4),\n    height: \"5ch\",\n  },\n  audioplayer: {\n    margin: theme.spacing(2),\n  },\n}));\n\nconst SongDetailPage = (props) => {\n  const classes = useStyles();\n  const fixedHeightPaper = clsx(classes.paper);\n  const history = useHistory();\n\n  // from props\n  const web3 = props.web3;\n  const accounts = props.accounts;\n  const contract = props.contract;\n\n  const musicList = props.musicList;\n  const setMusicList = props.setMusicList;\n  const setPage = props.setPage;\n\n  // for alert msg\n  const callAlert = props.callAlert;\n\n  // states\n  const [songHash, setSongHash] = useState(\"\");\n  const [songName, setSongName] = useState(\"\");\n  const [songArtist, setSongArtist] = useState(\"\");\n  const [searchHash, setSearchHash] = useState(\"\");\n  const [songData, setSongData] = useState({});\n  const [isMyMusic, setIsMyMusic] = useState(false);\n  const [isPurchased, setIsPurchased] = useState(false);\n  const [copyrightChain, setCopyrightChain] = useState([]);\n  const [userBalance, setUserBalance] = useState(0);\n\n  const { queryhash } = useParams();\n\n  useEffect(() => {\n    setPage(\"Detail\");\n    setSearchHash(queryhash);\n  }, []);\n\n  useEffect(async () => {\n    await getMusicByHash();\n  }, [accounts, contract, queryhash]);\n\n  useEffect(async () => {\n    await getUserBalance();\n  }, [accounts, contract]);\n\n  // const testGetMusic = async () => {\n  //   const result = await contract.methods\n  //     .getMusic(searchMusic, searchArtist)\n  //     .call({ from: accounts[0] });\n  //   console.log(result);\n  //   console.log(result.ipfsHash);\n  //   setSongHash(result.ipfsHash);\n  // };\n\n  const getMusicByHash = async () => {\n    if (contract.methods == undefined) {\n      return;\n    } else if (accounts.length == 0) {\n      return;\n    }\n    const result = await contract.methods\n      .getMusicByHash(queryhash)\n      .call({ from: accounts[0] });\n    setSongData(result);\n    const result_own = await contract.methods\n      .findUploadMusic(queryhash)\n      .call({ from: accounts[0] });\n    setIsMyMusic(result_own);\n\n    const result_purchased = await contract.methods\n      .findBoughtMusic(queryhash)\n      .call({ from: accounts[0] });\n    setIsPurchased(result_purchased);\n\n    const result_chain = await contract.methods\n      .getMusicChainByHash(queryhash, 10)\n      .call({ from: accounts[0] });\n    console.log(\"result_chain\");\n    console.log(result_chain.filter((x) => x.ipfsHash !== \"\"));\n    setCopyrightChain(result_chain.filter((x) => x.ipfsHash !== \"\"));\n  };\n\n  const getUserBalance = async () => {\n    if (contract.methods == undefined) {\n      return;\n    } else if (accounts.length == 0) {\n      return;\n    }\n    const balance = await contract.methods\n      .getUserBalance()\n      .call({ from: accounts[0] });\n\n    setUserBalance(balance);\n\n    return balance;\n  };\n\n  const checkUserBalance = async () => {\n    const balance = await contract.methods\n      .getUserBalance()\n      .call({ from: accounts[0] });\n\n    setUserBalance(balance);\n\n    if (parseInt(balance) < 100) {\n      console.log(\"You have no enough balance!\");\n      return false;\n    }\n\n    return true;\n  };\n  const buyMusic = async () => {\n    const hasEnoughBalance = await checkUserBalance();\n\n    if (!hasEnoughBalance) {\n      return;\n    }\n\n    const result = await contract.methods\n      .buyMusicByHash(queryhash)\n      .send({ from: accounts[0] });\n    console.log(result);\n    await getMusicByHash();\n  };\n\n  return (\n    <Container maxWidth=\"lg\" className={classes.container}>\n      <Grid container spacing={3}>\n        <Grid item xs={12} md={8} lg={8}>\n          <Paper className={fixedHeightPaper}>\n            <div>\n              <Typography\n                component=\"h2\"\n                variant=\"h1\"\n                gutterBottom\n                style={{ color: \"white\", fontSize: 40 }}\n              >\n                {songData[\"name\"]}\n              </Typography>\n            </div>\n            <div>\n              <Typography\n                component=\"h2\"\n                variant=\"h6\"\n                gutterBottom\n                style={{ color: \"white\", fontSize: 20 }}\n              >\n                Artist : {songData[\"artist\"]}\n              </Typography>\n            </div>\n            <div>\n              <Typography\n                component=\"h2\"\n                variant=\"h6\"\n                gutterBottom\n                style={{ color: \"white\", fontSize: 20 }}\n              >\n                Upload Time :{\" \"}\n                {Moment.unix(songData[\"uploadTime\"])\n                  .zone(8)\n                  .format(\"MM/D/YYYY, hh:mm:ss\")}\n              </Typography>\n            </div>\n            <div>\n              <Typography\n                component=\"h2\"\n                variant=\"h6\"\n                gutterBottom\n                style={{ color: \"white\", fontSize: 20 }}\n              >\n                Ipfs Hash : {songData[\"ipfsHash\"]}\n              </Typography>\n            </div>\n            <div>\n              <Typography\n                component=\"h2\"\n                variant=\"h6\"\n                gutterBottom\n                style={{ color: \"white\", fontSize: 20 }}\n              >\n                Uploader : {songData[\"uploader\"]}\n              </Typography>\n            </div>\n\n            <Typography\n              component=\"h2\"\n              variant=\"h6\"\n              gutterBottom\n              style={{ color: \"white\", fontSize: 15 }}\n            >\n              {/* need to beautify UI */}\n              {/* {songData.hasOwnProperty('coverFrom') && Object.keys(songData).map((k) => {\n                return <div key={k} > {k} : {songData[k]}</div>\n              })\n              } */}\n            </Typography>\n\n            <form className={classes.inputForm} noValidate autoComplete=\"off\">\n              {/* <div>\n                \n                <TextField\n                  id='name-textfield'\n                  label='Name'\n                  placeholder=\"Type song's name...\"\n                  multiline\n                  variant='outlined'\n                  size='small'\n                  value={songName}\n                  onChange={(event) => {\n                    setSongName(event.target.value);\n                  }}\n                />\n                <TextField\n                  id='artist-textfield'\n                  label='Artist'\n                  placeholder=\"Type song's artist...\"\n                  multiline\n                  variant='outlined'\n                  size='small'\n                  value={songArtist}\n                  onChange={(event) => {\n                    setSongArtist(event.target.value);\n                  }}\n                />\n                <TextField\n                  id='music-hash-textfield'\n                  label='Hash'\n                  placeholder=\"Type song's hash...\"\n                  multiline\n                  variant='outlined'\n                  size='small'\n                  value={searchHash}\n                  onChange={(event) => {\n                    setSearchHash(event.target.value);\n                  }}\n                />\n              </div> */}\n\n              <div className={classes.testingButtons}>\n                <Button\n                  variant=\"contained\"\n                  disabled={\n                    !isMyMusic && !isPurchased && parseInt(userBalance) < 100\n                  }\n                  onClick={async () => {\n                    if (isMyMusic || isPurchased) {\n                      // code to call our footer music player\n                      let music_src = await downloadAudioIPFS(\n                        songData[\"ipfsHash\"]\n                      );\n                      console.log(music_src);\n                      // use songData[\"name\"],songData[\"artist\"],songData[\"uploader\"]\n                      let music = {\n                        id: songData[\"ipfsHash\"],\n                        name: songData[\"name\"],\n                        artist: songData[\"artist\"],\n                        onChoose: true,\n                        onPlay: true,\n                        src: music_src,\n                      };\n                      let newList = musicList.map((m) => {\n                        m.onPlay = true;\n                        m.onChoose = false;\n                        return m;\n                      });\n                      setMusicList([...newList, music]);\n                    } else {\n                      buyMusic();\n                    }\n                  }}\n                >\n                  {isMyMusic || isPurchased ? \"Play Music\" : \"Buy Music\"}\n                </Button>\n              </div>\n            </form>\n            <Typography\n              component=\"h2\"\n              variant=\"h6\"\n              gutterBottom\n              style={{ color: \"orange\", fontSize: 20 }}\n            >\n              {parseInt(userBalance) < 100 && !isMyMusic && !isPurchased\n                ? \"No enough balance!\"\n                : \"\"}\n            </Typography>\n          </Paper>\n        </Grid>\n        <Grid item xs={12} md={4} lg={4}>\n          <Paper className={fixedHeightPaper}>\n            <Typography\n              component=\"h2\"\n              variant=\"h6\"\n              gutterBottom\n              style={{ color: \"white\", fontSize: 20 }}\n            >\n              Copyright Chain\n            </Typography>\n\n            <Timeline align=\"right\">\n              {copyrightChain.length &&\n                copyrightChain.map((ent, index) => {\n                  return (\n                    <TimelineItem key={ent.ipfsHash}>\n                      <TimelineOppositeContent>\n                        <Typography color=\"textSecondary\">\n                          {ent.artist}\n                        </Typography>\n                      </TimelineOppositeContent>\n                      <TimelineSeparator>\n                        <TimelineDot\n                          color={index == 0 ? \"secondary\" : \"primary\"}\n                        />\n                        <TimelineConnector />\n                      </TimelineSeparator>\n                      <TimelineContent>\n                        <Typography>\n                          {/* <Link to={`/detail/${ent.ipfsHash}`}>{ent.name}</Link> */}\n                          {searchHash == ent.ipfsHash ? (\n                            ent.name\n                          ) : (\n                            <Button\n                              onClick={() => {\n                                history.push(`/detail/${ent.ipfsHash}`);\n                              }}\n                            >\n                              {ent.name}\n                            </Button>\n                          )}\n                        </Typography>\n                      </TimelineContent>\n                    </TimelineItem>\n                  );\n                })}\n            </Timeline>\n          </Paper>\n        </Grid>\n      </Grid>\n    </Container>\n  );\n};\n\nexport default SongDetailPage;\n"]},"metadata":{},"sourceType":"module"}